<h4 class="text-uppercase font-weight-bold mt-4">Sign up for jobs</h4>
{% include '/user/_signup_head.html.twig' %}
{% if opportunities | length == 0 %}
<div class="alert alert-warning mt-5">No jobs here!</div>
{% endif %}
{% set month = ''%}
<div class="row p-3">
{% for job in opportunities %}
{% if month != job.shift.month %}
{% set month = job.shift.month %}
<h5 class="col-12 p-0 mt-2 font-weight-bold">{{ job.shift.month }}</h5>
{% endif %}
    {% include '/user/_job_card.html.twig' %}
{% endfor %}
</div>
<script>
function submitInterest(job_id, uninterested = false) {
    orgurl = "{{ signup_shift.url }}";
    if (uninterested)
         orgurl = "{{ set_uninterested.url }}";
    var url = orgurl.replace("ID", job_id);
    $.ajax({
        beforeSend: function(req) {
          req.setRequestHeader("Accept", "application/json");
        },
        type: "POST",
        url: url,
        data: $( "#interest_form_" + job_id ).serialize(),
        dataType: "text",
        async: true,
      }).done( function( cont, textStatus, xhr ) {
        $( "#item-" + job_id ).hide();
        icount = $( "#interested_count" ).text();
        ocount = $( "#opportunities_count" ).text();
        ocount--;
        if (!uninterested)
            icount++;
        $( "#interested_count" ).text(icount);
        $( "#opportunities_count" ).text(ocount);
        $( "#signupCount" ).text(ocount);
      }).fail(function(xhr, status, error) {
            errmsg = "Failed signing you up.\n";
            alert(errmsg);
    });
    return false;
}
</script>
